<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8" />
  <title>Promosyonlar — DugunSepeti</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="description" content="DugunSepeti promosyonlar ve masa süsleme siparişleri.">

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">

  <style>
    :root{
      --bg:#020617;
      --bg-soft:#050816;
      --fg:#f9fafb;
      --muted:#9ca3af;
      --accent:#f97316;
      --accent-soft:rgba(249,115,22,0.16);
      --card:#020617;
      --card-border:#1f2937;
      --chip:#020617;
    }

    *{box-sizing:border-box;margin:0;padding:0}
    html,body{height:100%}
    body{
      font-family:Inter, system-ui, -apple-system, "Segoe UI", sans-serif;
      color:var(--fg);
      background:
        radial-gradient(circle at 0% 0%, rgba(236,72,153,0.25), transparent 55%),
        radial-gradient(circle at 100% 0%, rgba(249,115,22,0.22), transparent 55%),
        radial-gradient(circle at 50% 100%, rgba(59,130,246,0.35), transparent 55%),
        #020617;
      -webkit-font-smoothing:antialiased;
    }

    .shell{
      min-height:100vh;
      display:flex;
      flex-direction:column;
      padding:18px 22px 26px;
    }

    header{
      display:flex;
      align-items:center;
      justify-content:space-between;
      margin-bottom:18px;
    }

    .header-left{
      display:flex;
      align-items:center;
      gap:10px;
    }

    .header-dot{
      width:9px;
      height:9px;
      border-radius:999px;
      background:#38bdf8;
      box-shadow:0 0 0 4px rgba(56,189,248,0.3);
    }

    .header-title{
      font-size:15px;
      font-weight:600;
      display:flex;
      align-items:center;
      gap:6px;
    }

    .header-sub{
      font-size:12px;
      color:var(--muted);
      margin-top:2px;
    }

    .header-right{
      display:flex;
      align-items:center;
      gap:12px;
      font-size:12px;
    }

    .header-right span{color:var(--muted);}
    .header-right b{color:var(--fg);}

    .btn{
      padding:7px 14px;
      border-radius:999px;
      border:1px solid rgba(148,163,184,0.6);
      background:rgba(15,23,42,0.92);
      color:var(--fg);
      font-size:12px;
      cursor:pointer;
      display:inline-flex;
      align-items:center;
      gap:6px;
      text-decoration:none;
    }

    .btn-primary{
      border-color:transparent;
      background:linear-gradient(135deg,#f97316,#ec4899);
      box-shadow:0 18px 38px rgba(249,115,22,0.55);
      font-weight:600;
    }

    .btn-ghost{
      background:rgba(15,23,42,0.8);
    }

    main{
      flex:1;
      display:flex;
      flex-direction:column;
      gap:14px;
    }

    .section-header{
      display:flex;
      justify-content:space-between;
      align-items:flex-end;
      gap:10px;
    }

    .section-header h1{
      font-size:22px;
      letter-spacing:.01em;
    }

    .section-header p{
      font-size:13px;
      color:var(--muted);
      margin-top:4px;
    }

    .filter-chips{
      display:flex;
      flex-wrap:wrap;
      gap:8px;
      font-size:11px;
      margin-top:8px;
    }

    .chip{
      padding:4px 9px;
      border-radius:999px;
      border:1px solid rgba(55,65,81,0.9);
      background:var(--chip);
      color:var(--muted);
    }

    .chip-active{
      border-color:rgba(56,189,248,0.9);
      color:#e0f2fe;
      background:var(--accent-soft);
    }

    .product-grid{
      margin-top:12px;
      display:grid;
      grid-template-columns:repeat(auto-fit, minmax(220px,1fr));
      gap:14px;
    }

    .card{
      background:rgba(15,23,42,0.94);
      border-radius:18px;
      border:1px solid rgba(15,23,42,1);
      box-shadow:0 22px 60px rgba(0,0,0,0.85);
      overflow:hidden;
      display:flex;
      flex-direction:column;
      min-height:260px;
    }

    .card-media{
      position:relative;
      height:150px;
      background:#020617;
      overflow:hidden;
    }

    .card-media img{
      width:100%;
      height:100%;
      object-fit:cover;
      display:block;
    }

    .card-body{
      padding:10px 12px 12px;
      display:flex;
      flex-direction:column;
      gap:6px;
    }

    .card-title{
      font-size:14px;
      font-weight:600;
    }

    .card-sub{
      font-size:11px;
      color:var(--muted);
      display:flex;
      align-items:center;
      gap:6px;
    }

    .rating-stars{
      color:#facc15;
      font-size:11px;
    }

    .thumb-row{
      margin-top:6px;
      display:flex;
      gap:6px;
      overflow-x:auto;
      padding-bottom:3px;
    }

    .thumb{
      width:42px;
      height:42px;
      border-radius:10px;
      background:#020617;
      border:1px solid rgba(31,41,55,0.9);
      flex:0 0 auto;
      overflow:hidden;
    }

    .thumb img{
      width:100%;
      height:100%;
      object-fit:cover;
      display:block;
    }

    .card-actions{
      margin-top:8px;
      display:flex;
      justify-content:space-between;
      gap:8px;
    }

    .card-actions .btn{
      flex:1;
      justify-content:center;
      font-size:12px;
      padding:7px 8px;
    }

    .btn-fav{
      border-color:rgba(55,65,81,0.9);
      background:rgba(15,23,42,0.8);
    }

    .qty-control{
      display:inline-flex;
      align-items:center;
      gap:6px;
      padding:4px 8px;
      border-radius:999px;
      border:1px solid rgba(55,65,81,0.9);
      background:rgba(15,23,42,0.9);
    }

    .qty-btn{
      width:20px;
      height:20px;
      border-radius:999px;
      border:0;
      background:rgba(37,99,235,0.9);
      color:#f9fafb;
      font-size:13px;
      line-height:1;
      cursor:pointer;
      display:flex;
      align-items:center;
      justify-content:center;
    }

    .qty-value{
      min-width:18px;
      text-align:center;
      font-size:12px;
    }

    .cart-panel{
      position:fixed;
      right:18px;
      top:70px;
      width:260px;
      background:rgba(15,23,42,0.97);
      border-radius:16px;
      border:1px solid rgba(148,163,184,0.4);
      box-shadow:0 22px 60px rgba(0,0,0,0.75);
      padding:10px 12px 12px;
      z-index:50;
      font-size:12px;
    }

    .cart-header{
      display:flex;
      justify-content:space-between;
      align-items:center;
      margin-bottom:4px;
    }

    .cart-title{
      font-weight:600;
      font-size:13px;
    }

    .cart-body{
      max-height:210px;
      overflow:auto;
      margin-top:4px;
    }

    .cart-items{
      list-style:none;
      margin:0;
      padding:0;
    }

    .cart-item{
      padding:4px 0;
      border-bottom:1px dashed rgba(55,65,81,0.7);
    }

    .cart-item:last-child{
      border-bottom:none;
    }

    .cart-item-title{
      font-size:12px;
      font-weight:500;
    }

    .cart-item-meta{
      font-size:11px;
      color:var(--muted);
    }

    .cart-empty{
      font-size:11px;
      color:var(--muted);
    }

    .cart-footer{
      display:flex;
      justify-content:space-between;
      align-items:center;
      margin-top:8px;
      padding-top:6px;
      border-top:1px solid rgba(55,65,81,0.9);
      font-size:12px;
    }

    .cart-total-label{
      color:var(--muted);
    }

    .cart-total-value{
      font-weight:600;
    }

    .cart-chip{
      display:inline-flex;
      align-items:center;
      gap:6px;
      padding:4px 9px;
      border-radius:999px;
      border:1px solid rgba(148,163,184,0.6);
      background:rgba(15,23,42,0.92);
      font-size:11px;
    }

    .cart-count-badge{
      min-width:18px;
      height:18px;
      border-radius:999px;
      background:var(--accent);
      color:#020617;
      display:flex;
      align-items:center;
      justify-content:center;
      font-weight:600;
      font-size:11px;
    }

    @media (max-width:720px){
      .shell{padding:14px 12px 20px;}
      header{flex-direction:column;align-items:flex-start;gap:8px;}
      .section-header{flex-direction:column;align-items:flex-start;}
    }
  </style>

  <!-- Firebase -->
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-firestore.js"></script>
  <script>
    var firebaseConfig = {
      apiKey: "AIzaSyChBoQ1PeASYybsUFyZ_iyCKwCgcq2SLPk",
      authDomain: "wedsystem-e080a.firebaseapp.com",
      databaseURL: "https://wedsystem-e080a-default-rtdb.europe-west1.firebasedatabase.app",
      projectId: "wedsystem-e080a",
      storageBucket: "wedsystem-e080a.firebasestorage.app",
      messagingSenderId: "90318782559",
      appId: "1:90318782559:web:374f51b404735c36151bea",
      measurementId: "G-YBXXF4V5RV"
    };
    if (!firebase.apps.length) firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();
  </script>
</head>

<body>
  <div class="shell">
    <header>
      <div class="header-left">
        <div class="header-dot"></div>
        <div>
          <div class="header-title">DugunSepeti</div>
          <div class="header-sub">Masa üstü hediyelikler ve promosyonlar</div>
        </div>
      </div>
      <div class="header-right">
        <span>Düğün ID: <b id="navWedding">-</b></span>
        <div class="cart-chip">
          Sepet
          <span id="cartCount" class="cart-count-badge">0</span>
        </div>
        <a href="admin.html" class="btn btn-primary">Admin Paneli</a>
      </div>
    </header>

    <div class="cart-panel" id="cartPanel">
      <div class="cart-header">
        <div class="cart-title">Sepet</div>
      </div>
      <div class="cart-body">
        <div id="cartEmpty" class="cart-empty">Sepetiniz boş.</div>
        <ul id="cartItems" class="cart-items"></ul>
      </div>
      <div class="cart-footer">
        <span class="cart-total-label">Toplam</span>
        <span id="cartTotal" class="cart-total-value">0 ₺</span>
      </div>
    </div>

    <main>
      <div class="section-header">
        <div>
          <h1>Masa Üstü Hediyelikler</h1>
          <p>Çiçek, mum, mini sukulent ve QR kart dahil, salonunuzla uyumlu masa üstü çözümleri.</p>
          <div class="filter-chips">
            <span class="chip chip-active">Tümü</span>
            <span class="chip">Çiçek</span>
            <span class="chip">Bitki</span>
            <span class="chip">Mum</span>
            <span class="chip">Lavanta &amp; Koku</span>
            <span class="chip">QR / Fotoğraf</span>
          </div>
        </div>
      </div>

      <section class="product-grid">
        <!-- 1: Table Roses -->
        <article class="card" data-product-id="roses">
          <div class="card-media">
            <img src="https://picsum.photos/seed/promo-roses-main/600/400" alt="Table Roses" />
          </div>
          <div class="card-body">
            <div class="card-title">Masalarda Gül</div>
            <div class="card-sub">Ankara · <span class="rating-stars">★★★★★</span> · 6 değerlendirme</div>
            <div class="thumb-row">
              <div class="thumb"><img src="https://picsum.photos/seed/promo-roses-1/120/120" alt="" /></div>
              <div class="thumb"><img src="https://picsum.photos/seed/promo-roses-2/120/120" alt="" /></div>
              <div class="thumb"><img src="https://picsum.photos/seed/promo-roses-3/120/120" alt="" /></div>
            </div>
            <div class="card-actions">
              <div class="qty-control">
                <button type="button" class="qty-btn" data-dir="-1">−</button>
                <span class="qty-value">1</span>
                <button type="button" class="qty-btn" data-dir="1">+</button>
              </div>
              <button type="button" class="btn btn-primary add-to-cart">Sepete Ekle</button>
            </div>
          </div>
        </article>

        <!-- 2: Mini Succulents -->
        <article class="card" data-product-id="succulent">
          <div class="card-media">
            <img src="https://picsum.photos/seed/promo-succulent-main/600/400" alt="Mini Succulents" />
          </div>
          <div class="card-body">
            <div class="card-title">Mini Succulents</div>
            <div class="card-sub">Ankara · <span class="rating-stars">★★★★☆</span> · 32 değerlendirme</div>
            <div class="thumb-row">
              <div class="thumb"><img src="https://picsum.photos/seed/promo-succulent-1/120/120" alt="" /></div>
              <div class="thumb"><img src="https://picsum.photos/seed/promo-succulent-2/120/120" alt="" /></div>
              <div class="thumb"><img src="https://picsum.photos/seed/promo-succulent-3/120/120" alt="" /></div>
            </div>
            <div class="card-actions">
              <button type="button" class="btn btn-primary">Sepete Ekle</button>
              <button type="button" class="btn btn-fav">☆ Favori</button>
            </div>
          </div>
        </article>

        <!-- 3: Scented Candles -->
        <article class="card" data-product-id="candles">
          <div class="card-media">
            <img src="https://picsum.photos/seed/promo-candles-main/600/400" alt="Scented Candles" />
          </div>
          <div class="card-body">
            <div class="card-title">Scented Candles</div>
            <div class="card-sub">Ankara · <span class="rating-stars">★★★★☆</span> · 19 değerlendirme</div>
            <div class="thumb-row">
              <div class="thumb"><img src="https://picsum.photos/seed/promo-candles-1/120/120" alt="" /></div>
              <div class="thumb"><img src="https://picsum.photos/seed/promo-candles-2/120/120" alt="" /></div>
              <div class="thumb"><img src="https://picsum.photos/seed/promo-candles-3/120/120" alt="" /></div>
            </div>
            <div class="card-actions">
              <button type="button" class="btn btn-primary">Sepete Ekle</button>
              <button type="button" class="btn btn-fav">☆ Favori</button>
            </div>
          </div>
        </article>

        <!-- 4: Honey Jar / Wood Set -->
        <article class="card" data-product-id="honey">
          <div class="card-media">
            <img src="https://picsum.photos/seed/promo-honey-main/600/400" alt="Messages on Wood" />
          </div>
          <div class="card-body">
            <div class="card-title">Messages on Wood</div>
            <div class="card-sub">Ankara · <span class="rating-stars">★★★★★</span> · 28 değerlendirme</div>
            <div class="thumb-row">
              <div class="thumb"><img src="https://picsum.photos/seed/promo-honey-1/120/120" alt="" /></div>
              <div class="thumb"><img src="https://picsum.photos/seed/promo-honey-2/120/120" alt="" /></div>
              <div class="thumb"><img src="https://picsum.photos/seed/promo-honey-3/120/120" alt="" /></div>
            </div>
            <div class="card-actions">
              <button type="button" class="btn btn-primary">Sepete Ekle</button>
              <button type="button" class="btn btn-fav">☆ Favori</button>
            </div>
          </div>
        </article>

        <!-- 5: Lavanta Parfüm -->
        <article class="card" data-product-id="lavender">
          <div class="card-media">
            <img src="https://picsum.photos/seed/promo-lavender-main/600/400" alt="Lavender Perfume" />
          </div>
          <div class="card-body">
            <div class="card-title">Lavender Perfume</div>
            <div class="card-sub">Ankara · <span class="rating-stars">★★★☆☆</span> · 39 değerlendirme</div>
            <div class="thumb-row">
              <div class="thumb"><img src="https://picsum.photos/seed/promo-lavender-1/120/120" alt="" /></div>
              <div class="thumb"><img src="https://picsum.photos/seed/promo-lavender-2/120/120" alt="" /></div>
              <div class="thumb"><img src="https://picsum.photos/seed/promo-lavender-3/120/120" alt="" /></div>
            </div>
            <div class="card-actions">
              <button type="button" class="btn btn-primary">Sepete Ekle</button>
              <button type="button" class="btn btn-fav">☆ Favori</button>
            </div>
          </div>
        </article>

        <!-- 6: Sticker / Magnet Set -->
        <article class="card" data-product-id="sticker">
          <div class="card-media">
            <img src="https://picsum.photos/seed/promo-sticker-main/600/400" alt="Sticker / Magnet Set" />
          </div>
          <div class="card-body">
            <div class="card-title">Sticker / Magnet Set</div>
            <div class="card-sub">Ankara · <span class="rating-stars">★★★★☆</span> · 43 değerlendirme</div>
            <div class="thumb-row">
              <div class="thumb"><img src="https://picsum.photos/seed/promo-sticker-1/120/120" alt="" /></div>
              <div class="thumb"><img src="https://picsum.photos/seed/promo-sticker-2/120/120" alt="" /></div>
              <div class="thumb"><img src="https://picsum.photos/seed/promo-sticker-3/120/120" alt="" /></div>
            </div>
            <div class="card-actions">
              <button type="button" class="btn btn-primary">Sepete Ekle</button>
              <button type="button" class="btn btn-fav">☆ Favori</button>
            </div>
          </div>
        </article>

        <!-- 7: QR Foto Set -->
        <article class="card" data-product-id="qr">
          <div class="card-media">
            <img src="https://picsum.photos/seed/promo-qr-main/600/400" alt="QR Photo Card" />
          </div>
          <div class="card-body">
            <div class="card-title">QR Photo Card</div>
            <div class="card-sub">Ankara · <span class="rating-stars">★★★★☆</span> · 25 değerlendirme</div>
            <div class="thumb-row">
              <div class="thumb"><img src="https://picsum.photos/seed/promo-qr-1/120/120" alt="" /></div>
              <div class="thumb"><img src="https://picsum.photos/seed/promo-qr-2/120/120" alt="" /></div>
              <div class="thumb"><img src="https://picsum.photos/seed/promo-qr-3/120/120" alt="" /></div>
            </div>
            <div class="card-actions">
              <button type="button" class="btn btn-primary">Sepete Ekle</button>
              <button type="button" class="btn btn-fav">☆ Favori</button>
            </div>
          </div>
        </article>

        <!-- 8: Custom Favors -->
        <article class="card" data-product-id="custom">
          <div class="card-media">
            <img src="https://picsum.photos/seed/promo-custom-main/600/400" alt="Custom Favors" />
          </div>
          <div class="card-body">
            <div class="card-title">Custom Favors</div>
            <div class="card-sub">Ankara · <span class="rating-stars">★★★☆☆</span> · Özel tasarım istek üzerine</div>
            <div class="thumb-row">
              <div class="thumb"><img src="https://picsum.photos/seed/promo-custom-1/120/120" alt="" /></div>
              <div class="thumb"><img src="https://picsum.photos/seed/promo-custom-2/120/120" alt="" /></div>
            </div>
            <div class="card-actions">
              <button type="button" class="btn btn-primary">Sepete Ekle</button>
              <button type="button" class="btn btn-fav">☆ Favori</button>
            </div>
          </div>
        </article>

      </section>
    </main>
  </div>

  <script>
    function detectWeddingId(){
      const params = new URLSearchParams(window.location.search);
      const fromQuery = params.get('wedding');
      const fromStorage = localStorage.getItem('currentWeddingId') || localStorage.getItem('weddingId');
      const currentWeddingId = fromQuery || fromStorage || null;
      const navSpan = document.getElementById('navWedding');
      if(navSpan){ navSpan.textContent = currentWeddingId || '-'; }
    }

    const PRODUCTS = {
      roses:    { name: 'Masalarda Gül',           price: 800 },
      succulent:{ name: 'Mini Succulents',         price: 600 },
      candles:  { name: 'Scented Candles',         price: 550 },
      honey:    { name: 'Messages on Wood',        price: 650 },
      lavender: { name: 'Lavender Perfume',        price: 450 },
      sticker:  { name: 'Sticker / Magnet Set',    price: 350 },
      qr:       { name: 'QR Photo Card',           price: 300 },
      custom:   { name: 'Custom Favors',           price: 700 }
    };

    const cartState = {};

    function formatTry(amount){
      const n = Number(amount) || 0;
      try{
        return n.toLocaleString('tr-TR') + ' ₺';
      }catch(e){
        return n + ' ₺';
      }
    }

    function updateCartDom(){
      const itemsEl = document.getElementById('cartItems');
      const emptyEl = document.getElementById('cartEmpty');
      const totalEl = document.getElementById('cartTotal');
      const countEl = document.getElementById('cartCount');

      const entries = Object.values(cartState);
      let total = 0;
      let count = 0;

      if (!entries.length){
        if (itemsEl) itemsEl.innerHTML = '';
        if (emptyEl) emptyEl.style.display = 'block';
        if (totalEl) totalEl.textContent = '0 ₺';
        if (countEl) countEl.textContent = '0';
        return;
      }

      const parts = [];
      entries.forEach(it => {
        const line = (it.price || 0) * (it.qty || 0);
        total += line;
        count += (it.qty || 0);
        parts.push(
          `<li class="cart-item">` +
            `<div class="cart-item-title">${it.name}</div>` +
            `<div class="cart-item-meta">${it.qty} × ${formatTry(it.price)}</div>` +
          `</li>`
        );
      });

      if (itemsEl) itemsEl.innerHTML = parts.join('');
      if (emptyEl) emptyEl.style.display = 'none';
      if (totalEl) totalEl.textContent = formatTry(total);
      if (countEl) countEl.textContent = String(count);
    }

    function initPromotionsPage(){
      detectWeddingId();

      const cards = document.querySelectorAll('.card[data-product-id]');
      cards.forEach(card => {
        const pid = card.getAttribute('data-product-id');
        if (!pid || !PRODUCTS[pid]) return;

        let qty = 1;
        const qtyControl = card.querySelector('.qty-control');
        const qtyValueEl = qtyControl ? qtyControl.querySelector('.qty-value') : null;
        if (qtyControl && qtyValueEl){
          qtyValueEl.textContent = '1';
          qtyControl.querySelectorAll('.qty-btn').forEach(btn => {
            btn.addEventListener('click', () => {
              const dir = Number(btn.getAttribute('data-dir') || '0');
              qty = Math.max(1, qty + dir);
              qtyValueEl.textContent = String(qty);
            });
          });
        }

        const addBtn = card.querySelector('.add-to-cart') || card.querySelector('.btn-primary');
        if (addBtn){
          addBtn.addEventListener('click', () => {
            const baseQty = qtyControl ? qty : 1;
            const prev = cartState[pid]?.qty || 0;
            const product = PRODUCTS[pid];
            cartState[pid] = {
              name: product.name,
              price: product.price,
              qty: prev + baseQty
            };
            updateCartDom();
          });
        }
      });
    }

    window.addEventListener('DOMContentLoaded', initPromotionsPage);
  </script>
</body>
</html>